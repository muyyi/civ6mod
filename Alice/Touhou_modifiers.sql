-- Marisa
INSERT INTO Modifiers 
		(ModifierId, ModifierType, SubjectRequirementSetId)
VALUES	('SPY_CHOOSE_SKILL', 'MODIFIER_PLAYER_UNIT_GRANT_UNLIMITED_PROMOTION_CHOICES', NULL) ,
		('MARISA_ADD_TRADE_ROUTE_CAPACITY', 'EFFECT_ADJUST_TRADE_ROUTE_CAPACITY', 'PLAYER_DECLARED_FRIEND') ,
		('MARISA_GRANT_TRADER', 'MODIFIER_SINGLE_CITY_GRANT_UNIT_IN_CITY', 'PLAYER_DECLARED_FRIEND');

INSERT INTO ModifierArguments
		(ModifierId, Name, Value)
VALUES	('SPY_CHOOSE_SKILL', 'UnitType', 'UNIT_SPY'),
		('MARISA_ADD_TRADE_ROUTE_CAPACITY', 'Amount', 1) ,
		('MARISA_GRANT_TRADER', 'UnitType', 'UNIT_TRADER') ,
		('MARISA_GRANT_TRADER', 'Amount', 1);


INSERT INTO UnitPromotionModifiers 
		(UnitPromotionType, ModifierId)
VALUES	('PROMOTION_MARISA_L1L', 'GUNBOATDIPLOMACY_OPENBORDERS') ,
		('PROMOTION_MARISA_L1L', 'GUNBOATDIPLOMACY_INFLUENCEPOINTS') ,
		('PROMOTION_MARISA_L2L', 'UNIQUE_LEADER_ADD_VISIBILITY') ,
		-- 被宣友时，获得一条免费的商路和贸易路线
		('PROMOTION_MARISA_L2L', 'MARISA_ADD_TRADE_ROUTE_CAPACITY') ,
		('PROMOTION_MARISA_L2L', 'MARISA_GRANT_TRADER') ,
		('PROMOTION_MARISA_L3L', 'POTALA_PALACE_DIPLOMATIC_GOVERNMENT_SLOT') ,
		('PROMOTION_MARISA_L1R', 'UNIQUE_LEADER_ADD_SPY_CAPACITY') ,
		('PROMOTION_MARISA_L1R', 'SPY_QUARTERMASTER') ,
		('PROMOTION_MARISA_L2R', 'UNIQUE_LEADER_SPIES_START_PROMOTED') ,
		('PROMOTION_MARISA_L2R', 'SPY_CHOOSE_SKILL') ,
		-- 暂时先将效果改为附赠一个间谍并提高一个间谍容量
		('PROMOTION_MARISA_L1R', 'UNIQUE_LEADER_ADD_SPY_CAPACITY') ,
		('PROMOTION_MARISA_L3R', 'UNIQUE_LEADER_ADD_SPY_UNIT') ,
		-- ('PROMOTION_MARISA_L3R', 'SPY_MARISA') ,
		-- ('PROMOTION_MARISA_L3R', 'SPY_MARISA_GREAT_WORK_HEIST') ,
		-- ('PROMOTION_MARISA_L3R', 'SPY_MARISA_SIPHON_FUND') ,
		-- 暂时先将效果改为从同盟时获得贸易路线，同时双方获得更多贸易加成(Arsenal of Democracy)
		('PROMOTION_MARISA_L4R', 'ALLIANCE_ADJUST_PLAYER_TRADE_ROUTE_CAPACITY') ,
		('PROMOTION_MARISA_L4R', 'ARSENALOFDEMOCRACY_TRADEROUTEFOODTOALLY') ,
		('PROMOTION_MARISA_L4R', 'ARSENALOFDEMOCRACY_TRADEROUTEPRODUCTIONTOALLY') ,
		('PROMOTION_MARISA_L4R', 'ARSENALOFDEMOCRACY_TRADEROUTEFOODFROMALLY') ,
		('PROMOTION_MARISA_L4R', 'ARSENALOFDEMOCRACY_TRADEROUTEPRODUCTIONFROMALLY') ,
		('PROMOTION_MARISA_L4R', 'ARSENALOFDEMOCRACY_ALLIANCEPOINTS') ;

-- Shinki
-- Can see any thing
CREATE TABLE IF NOT EXISTS HiddenStrategics AS 
	SELECT ResourceType FROM Resources 
	WHERE ResourceClassType="RESOURCECLASS_STRATEGIC" AND PrereqTech IS NOT NULL ;


INSERT INTO Modifiers 
	(ModifierId, 	ModifierType, 	RunOnce, Permanent, OwnerRequirementSetId, SubjectRequirementSetId)
SELECT	'ALICE_PLAYER_CAN_SEE' || HiddenStrategics.ResourceType, 	'MODIFIER_PLAYER_GRANT_FREE_RESOURCE_VISIBILITY', 1, 1, NULL, NULL
	FROM HiddenStrategics;


INSERT INTO ModifierArguments
	(ModifierId, Name, Value)
SELECT 'ALICE_PLAYER_CAN_SEE' || HiddenStrategics.ResourceType, 'ResourceType', HiddenStrategics.ResourceType	
	FROM HiddenStrategics;

INSERT INTO UnitPromotionModifiers
	(UnitPromotionType, ModifierId)
SELECT 'PROMOTION_SHINKI_L1', 'ALICE_PLAYER_CAN_SEE' || HiddenStrategics.ResourceType
	FROM HiddenStrategics;


-- Can build any improvement
INSERT INTO Modifiers 
		(ModifierId, ModifierType, RunOnce, Permanent, OwnerRequirementSetId, SubjectRequirementSetId)
SELECT 'ALICE_PLAYER_CAN_BUILD_' || ImprovementType, 'MODIFIER_PLAYER_ADJUST_VALID_IMPROVEMENT', 0, 0, NULL, NULL
FROM Improvements;

INSERT INTO ModifierArguments
		(ModifierId, Name, Value)
SELECT 'ALICE_PLAYER_CAN_BUILD_' || ImprovementType, 'ImprovementType', ImprovementType
FROM Improvements;

INSERT INTO UnitPromotionModifiers
		(UnitPromotionType, ModifierId)
SELECT 'PROMOTION_SHINKI_L2', 'ALICE_PLAYER_CAN_BUILD_' || ImprovementType
FROM Improvements;

-- Some wonder stronger
-- 先随便用2个技能代替试试
INSERT INTO UnitPromotionModifiers
	(UnitPromotionType, ModifierId)
VALUES	('PROMOTION_SHINKI_L3', 'PETRA_DESERT_FOOD') ,
		('PROMOTION_SHINKI_L4', 'PETRA_DESERT_GOLD') ;

-- marisa
-- INSERT INTO Modifiers
-- (ModifierId, ModifierType, SubjectRequirementSetId)
-- VALUES
-- ('TRAIT_RANGED_STRONG_WHEN_ATTACKING', 'MODIFIER_PLAYER_UNITS_ATTACH_MODIFIER', 'REQSET_UNIT_IS_RANGED')，
-- ('TRAIT_RANGED_STRONG_WHEN_ATTACKING_MODIFIER', 'MODIFIER_PLAYER_UNITS_ADJUST_COMBAT_STRENGTH', 'UNIT_STRONG_WHEN_ATTACKING_REQUIREMENTS')，
-- ('TRAIT_RANGED_WEAK_WHEN_DEFENDING', 'MODIFIER_PLAYER_UNITS_ATTACH_MODIFIER', 'REQSET_UNIT_IS_RANGED')，
-- ('TRAIT_RANGED_WEAK_WHEN_DEFENDING_MODIFIER', 'MODIFIER_PLAYER_UNITS_ADJUST_COMBAT_STRENGTH', 'UNIT_WEAK_WHEN_DEFENDING_REQUIREMENTS');


-- TEST_MARISA
INSERT INTO Requirements
	(RequirementId, RequirementType)
VALUES	('REQ_UNIT_IS_RANGED', 'REQUIREMENT_UNIT_TYPE_MATCHES') ;


INSERT INTO RequirementArguments 
	(RequirementId, Name, Value)
VALUES ('REQ_UNIT_IS_RANGED',	'UnitType',	'UNIT_TEST_MARISA') ;
		

INSERT INTO RequirementSets 
	(RequirementSetId, RequirementSetType)

VALUES ('REQSET_UNIT_IS_RANGED', 'REQUIREMENTSET_TEST_ALL') ;


		
INSERT INTO RequirementSetRequirements
	(RequirementSetId,	RequirementId)

VALUES	('REQSET_UNIT_IS_RANGED', 'REQ_UNIT_IS_RANGED') ;




INSERT INTO Modifiers 
		(ModifierId, ModifierType, SubjectRequirementSetId)
VALUES	('MARISA_MASTER_SPARK_1_MODIFIER', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH', NULL) ,
		('MARISA_MASTER_SPARK_1', 'MODIFIER_SINGLE_UNIT_ATTACH_MODIFIER', NULL) ,
		('MARISA_MASTER_SPARK_2_MODIFIER', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH', NULL) ,
		('MARISA_MASTER_SPARK_2', 'MODIFIER_PLAYER_UNITS_ATTACH_MODIFIER', 'REQSET_UNIT_IS_TEST_MARISA') ,
		('MARISA_MASTER_SPARK_VS_DISTRICT_DEFENSES_MODIFIER', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH', NULL) ,
		('MARISA_MASTER_SPARK_VS_DISTRICT_DEFENSES', 'MODIFIER_PLAYER_UNITS_ATTACH_MODIFIER', 'REQSET_UNIT_IS_TEST_MARISA') ,
		('MARISA_MASTER_SPARK_3_MODIFIER', 'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH', NULL) ,
		('MARISA_MASTER_SPARK_3', 'MODIFIER_PLAYER_UNITS_ATTACH_MODIFIER', 'REQSET_UNIT_IS_TEST_MARISA') ,

		('COMMANDER_RANGED_STRONG_WHEN_ATTACKING_MODIFIER', 'MODIFIER_PLAYER_UNITS_ADJUST_COMBAT_STRENGTH', 'UNIT_STRONG_WHEN_ATTACKING_REQUIREMENTS'),
		('COMMANDER_RANGED_STRONG_WHEN_ATTACKING', 'MODIFIER_PLAYER_UNITS_ATTACH_MODIFIER', 'REQSET_UNIT_IS_RANGED'),
		('COMMANDER_RANGED_WEAK_WHEN_DEFENDING_MODIFIER', 'MODIFIER_PLAYER_UNITS_ADJUST_COMBAT_STRENGTH', 'UNIT_WEAK_WHEN_DEFENDING_REQUIREMENTS'),
		('COMMANDER_RANGED_WEAK_WHEN_DEFENDING', 'MODIFIER_PLAYER_UNITS_ATTACH_MODIFIER', 'REQSET_UNIT_IS_RANGED'),

		('SPEED_IGNORE_TERRAIN', 'MODIFIER_SINGLE_UNIT_ATTACH_MODIFIER', NULL),
		('SPEED_IGNORE_TERRAIN_MODIFIER', 'MODIFIER_PLAYER_UNITS_GRANT_ABILITY', NULL),
		('SPEED_IGNORE_ZONE', 'MODIFIER_PLAYER_UNIT_ADJUST_IGNORE_ZOC', NULL),
		('SPEED_MOVE_FAST', 'MODIFIER_PLAYER_UNITS_ADJUST_MOVEMENT', NULL);
		-- ('SPEED_RUN_AWAY', 'MODIFIER_PLAYER_UNITS_ADJUST_MOVEMENT', 'REQSET_MARISA_IS_DAMAGED');



INSERT INTO ModifierArguments
		(ModifierId, Name, Value)
VALUES	('MARISA_MASTER_SPARK_1', 'ModifierId', 'MARISA_MASTER_SPARK_1_MODIFIER'),
		('MARISA_MASTER_SPARK_1_MODIFIER', 'Amount', 10) ,
		('MARISA_MASTER_SPARK_2', 'ModifierId', 'MARISA_MASTER_SPARK_2_MODIFIER'),
		('MARISA_MASTER_SPARK_2_MODIFIER', 'Amount', 20) ,
		('MARISA_MASTER_SPARK_VS_DISTRICT_DEFENSES', 'ModifierId', 'MARISA_MASTER_SPARK_VS_DISTRICT_DEFENSES_MODIFIER'),
		('MARISA_MASTER_SPARK_VS_DISTRICT_DEFENSES_MODIFIER', 'Amount', 17) ,
		('MARISA_MASTER_SPARK_3', 'ModifierId', 'MARISA_MASTER_SPARK_3_MODIFIER'),
		('MARISA_MASTER_SPARK_3_MODIFIER', 'Amount', 30) ,

		('COMMANDER_RANGED_STRONG_WHEN_ATTACKING', 'ModifierId', 'COMMANDER_RANGED_STRONG_WHEN_ATTACKING_MODIFIER'),
		('COMMANDER_RANGED_STRONG_WHEN_ATTACKING_MODIFIER', 'Amount', 5) ,
		('COMMANDER_RANGED_WEAK_WHEN_DEFENDING', 'ModifierId', 'COMMANDER_RANGED_WEAK_WHEN_DEFENDING_MODIFIER'),
		('COMMANDER_RANGED_WEAK_WHEN_DEFENDING_MODIFIER', 'Amount', -5) ,

		('SPEED_IGNORE_TERRAIN', 'ModifierId', 'SPEED_IGNORE_TERRAIN_MODIFIER'),
		('SPEED_IGNORE_TERRAIN_MODIFIER', 'AbilityType', 'ABILITY_RELIGIOUS_IGNORE_TERRAIN_COST') ,
		('SPEED_IGNORE_ZONE', 'Ignore', 1),
		('SPEED_MOVE_FAST', 'Amount', 1) ;


INSERT INTO UnitPromotionModifiers 
		(UnitPromotionType, ModifierId)
VALUES	('PROMOTION_MARISA_DIPLOMAT_MASTERSPARK_1', 'GUNBOATDIPLOMACY_OPENBORDERS') ,
		('PROMOTION_MARISA_DIPLOMAT_MASTERSPARK_1', 'GUNBOATDIPLOMACY_INFLUENCEPOINTS') ,
		('PROMOTION_MARISA_DIPLOMAT_LADY_KILLER_1', 'UNIQUE_LEADER_ADD_VISIBILITY') ,
		('PROMOTION_MARISA_DIPLOMAT_FRIENDLY_1', 'TRAIT_BARBARIAN_CAMP_GOODY') ,

		('PROMOTION_MARISA_DIPLOMAT_LADY_KILLER_2', 'MARISA_ADD_TRADE_ROUTE_CAPACITY') ,
		('PROMOTION_MARISA_DIPLOMAT_LADY_KILLER_2', 'MARISA_GRANT_TRADER') ,

		('PROMOTION_MARISA_DIPLOMAT_LADY_KILLER_3', 'ALLIANCE_ADJUST_PLAYER_TRADE_ROUTE_CAPACITY') ,
		('PROMOTION_MARISA_DIPLOMAT_LADY_KILLER_3', 'ARSENALOFDEMOCRACY_TRADEROUTEFOODTOALLY') ,
		('PROMOTION_MARISA_DIPLOMAT_LADY_KILLER_3', 'ARSENALOFDEMOCRACY_TRADEROUTEPRODUCTIONTOALLY') ,
		('PROMOTION_MARISA_DIPLOMAT_LADY_KILLER_3', 'ARSENALOFDEMOCRACY_TRADEROUTEFOODFROMALLY') ,
		('PROMOTION_MARISA_DIPLOMAT_LADY_KILLER_3', 'ARSENALOFDEMOCRACY_TRADEROUTEPRODUCTIONFROMALLY') ,
		('PROMOTION_MARISA_DIPLOMAT_LOVE_PEACE', 'ARSENALOFDEMOCRACY_ALLIANCEPOINTS') ,

		('PROMOTION_MARISA_BATTLE_MASTER_SPARK_1', 'MARISA_MASTER_SPARK_1') ,
		('PROMOTION_MARISA_BATTLE_MASTER_SPARK_2', 'MARISA_MASTER_SPARK_2') ,
		-- 对城墙造成全额伤害，但仅限于近战，可能要改
		-- ('PROMOTION_MARISA_BATTLE_MASTER_SPARK_2', 'ENABLE_WALL_ATTACK') ,
		('PROMOTION_MARISA_BATTLE_MASTER_SPARK_2', 'MARISA_MASTER_SPARK_VS_DISTRICT_DEFENSES') ,

		('PROMOTION_MARISA_BATTLE_MASTER_SPARK_3', 'MARISA_MASTER_SPARK_3') ,
		-- 气球的效果，不仅加自己，还加周围右方单位，可能要改
		('PROMOTION_MARISA_BATTLE_MASTER_SPARK_3', 'OBSERVATION_INCREASED_SIGHT_RANGE') ,
		('PROMOTION_MARISA_BATTLE_MASTER_COMMANDER_1', 'COMMANDER_RANGED_STRONG_WHEN_ATTACKING') ,
		('PROMOTION_MARISA_BATTLE_MASTER_COMMANDER_1', 'COMMANDER_RANGED_WEAK_WHEN_DEFENDING') ,

		('PROMOTION_MARISA_BATTLE_MASTER_SPEED_1', 'SPEED_IGNORE_TERRAIN') ,
		('PROMOTION_MARISA_BATTLE_MASTER_SPEED_1', 'SPEED_IGNORE_ZONE') ,
		('PROMOTION_MARISA_BATTLE_MASTER_SPEED_2', 'SPEED_MOVE_FAST'),
		('PROMOTION_MARISA_BATTLE_MASTER_SPEED_2', 'EXPERT_MARKSMAN_ADDITIONAL_ATTACK');
